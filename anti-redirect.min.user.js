// ==UserScript==
// @name              anti-redirect (typescript)
// @author            Axetroy
// @collaborator      Axetroy
// @description       GM脚本, 去除各搜索引擎/常用网站的重定向
// @version           2.4.0
// @update            2018-01-04 17:59:06
// @grant             GM_xmlhttpRequest
// @include           *www.baidu.com*
// @include           *tieba.baidu.com*
// @include           *v.baidu.com*
// @include           *xueshu.baidu.com*
// @include           *www.google.*
// @include           *docs.google.*
// @include           *encrypted.google.com*
// @include           *www.so.com*
// @include           *www.zhihu.com*
// @include           *daily.zhihu.com*
// @include           *zhuanlan.zhihu.com*
// @include           *weibo.com*
// @include           *twitter.com*
// @include           *www.sogou.com*
// @include           *juejin.im*
// @connect           *
// @compatible        chrome  完美运行
// @compatible        firefox  完美运行
// @supportURL        http://www.burningall.com
// @run-at            document-start
// @contributionURL   troy450409405@gmail.com|alipay.com
// @downloadURL       https://github.com/axetroy/anti-redirect/raw/master/dist/anti-redirect.min.user.js
// @namespace         https://greasyfork.org/zh-CN/users/3400-axetroy
// @license           The MIT License (MIT); http://opensource.org/licenses/MIT
// ==/UserScript==

// Github源码:https://github.com/axetroy/anti-redirect


!function(t){function e(r){if(n[r])return n[r].exports;var o=n[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,e),o.l=!0,o.exports}var n={};e.m=t,e.c=n,e.d=function(t,n,r){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:r})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=4)}([function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(e,"__esModule",{value:!0});var o=n(14),i=function(t){function e(){var e=t.call(this)||this;return e.test=/example/,e.ANTI_REDIRECT_DONE_EVENT="anti-redirect-done",e.ANTI_REDIRECT_ORIGIN_HREF="anti-redirect-origin-href",e.config={debug:!1},e.on(e.ANTI_REDIRECT_DONE_EVENT,function(t,n){n&&(e.config.debug&&(t.style.backgroundColor="green"),t.setAttribute(e.ANTI_REDIRECT_ORIGIN_HREF,t.href),t.href=n)}),e}return r(e,t),e.prototype.setConfig=function(t){return this.config=t,this},e.prototype.onScroll=function(t){},e.prototype.onHover=function(t){},e.prototype.onInit=function(){return this},e}(o.default);e.Provider=i},function(t,e,n){"use strict";function r(t,e){var n=e.exec(t.href);if(!n||!n.length||!n[1])return"";var r="";try{r=decodeURIComponent(n[1])}catch(t){r=/https?:\/\//.test(n[1])?n[1]:""}return r}function o(t){return new d(t)}function i(t){return(t.innerText||t.textContent).trim()}function u(t,e){return void 0===e&&(e={}),function(n,r,o){return{configurable:!0,enumerable:o.enumerable,get:function(){return Object.defineProperty(this,r,{configurable:!0,enumerable:o.enumerable,value:p(o.value,t,e)}),this[r]}}}}function c(t,e){return void 0===e&&(e={}),function(n,r,o){return{configurable:!0,enumerable:o.enumerable,get:function(){return Object.defineProperty(this,r,{configurable:!0,enumerable:o.enumerable,value:h(o.value,t,e)}),this[r]}}}}function s(t){return v.is(t)}function a(t){return+(t.getAttribute(e.REDIRECT_NUM)||0)}function f(t){var n=a(t);t.setAttribute(e.REDIRECT_NUM,n+1+"")}function l(t){var n=a(t);n>0&&t.setAttribute(e.REDIRECT_NUM,n-1+"")}Object.defineProperty(e,"__esModule",{value:!0});var p=n(10),h=n(11),v=n(12);e.REDIRECT_NUM="redirect-count",e.matchLinkFromUrl=r;var d=function(){function t(t){this.queryStr=t,this.object={},this.object=this.toObject(t.replace(/^\?+/,""))}return t.prototype.toObject=function(t){var e={};return t.split("&").forEach(function(t){var n=t.split("=")||[],r=n[0]||"",o=n[1]||"";try{r=decodeURIComponent(n[0]||""),o=decodeURIComponent(n[1]||"")}catch(t){}r&&(e[r]=o)}),e},t.prototype.toString=function(){var t=[];for(var e in this.object)if(this.object.hasOwnProperty(e)){var n=this.object[e];t.push(e+"="+n)}return t.length?"?"+t.join("&"):""},t}();e.queryParser=o,e.getText=i,e.throttleDecorator=u,e.debounceDecorator=c,e.isInView=s,e.getRedirect=a,e.increaseRedirect=f,e.decreaseRedirect=l},function(t,e,n){!function(e,n){t.exports=n()}(0,function(){return function(t){function e(r){if(n[r])return n[r].exports;var o=n[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,e),o.l=!0,o.exports}var n={};return e.m=t,e.c=n,e.d=function(t,n,r){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:r})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=0)}([function(t,e,n){"use strict";function r(t){return"function"==typeof t}var o=this&&this.__assign||Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++){e=arguments[n];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}return t};Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t){void 0===t&&(t={}),this.config=t}return t.prototype.setConfig=function(t){void 0===t&&(t={}),this.config=o({},this.config,t)},t.prototype.create=function(e){return new t(e)},t.prototype.request=function(t,e,n,i,u){var c=this;return void 0===n&&(n=""),void 0===i&&(i={}),void 0===u&&(u={}),new Promise(function(s,a){var f={method:t,url:e,data:n,header:i},l=o({},f,u,c.config),p=l.onreadystatechange,h=l.onerror,v=l.onabort,d=l.ontimeout;l.synchronous=!0,l.onreadystatechange=function(t){try{r(p)&&p.call(this,t)}catch(t){a(t)}4===t.readyState&&(t.status>=200&&t.status<400?s(t):a(t))},l.onerror=function(t){try{r(h)&&h.call(this,t),a(t)}catch(t){a(t)}},l.onabort=function(t){try{r(v)&&v.call(this,t),a(t)}catch(t){a(t)}},l.ontimeout=function(t){try{r(d)&&d.call(this,t),a(t)}catch(t){a(t)}},c.config.debug&&console.log("%c["+f.method.toUpperCase()+"]%c: "+f.url,"color: green","color: #000;text-style: under-line"),GM_xmlhttpRequest(o({},l))})},t.prototype.get=function(t,e,n,r){return this.request("GET",t,e,n,r)},t.prototype.post=function(t,e,n,r){return this.request("POST",t,e,n,r)},t.prototype.put=function(t,e,n,r){return this.request("PUT",t,e,n,r)},t.prototype.delete=function(t,e,n,r){return this.request("DELETE",t,e,n,r)},t.prototype.head=function(t,e,n,r){return this.request("HEAD",t,e,n,r)},t}();e.Http=i;e.timeout=5e3;var u=new i({timeout:5e3});e.http=u,e.default=u}])})},function(t,e){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),n(5);var r=n(2),o=n(9),i=n(13),u=n(15),c=n(16),s=n(17),a=n(18),f=n(19),l=n(20),p=n(21),h=n(22),v=n(23),d=n(24),y=n(25),_=n(26),b=n(27),m=new o.App;r.default.setConfig({debug:!1}),m.setConfig({debug:!1}).provide([{name:"知乎",test:/www\.zhihu\.com/,provider:f.ZhihuProvider},{name:"知乎专栏",test:/zhuanlan\.zhihu\.com/,provider:i.ZhihuZhuanlanProvider},{name:"知乎日报",test:/daily\.zhihu\.com/,provider:u.ZhihuDailyProvider},{name:"Google搜索",test:/\w+\.google\./,provider:s.GoogleProvider},{name:"Google Docs",test:/docs\.google\.com/,provider:a.GoogleDocsProvider},{name:"360搜索",test:/www\.so\.com/,provider:l.SoProvider},{name:"新浪微博",test:/\.weibo\.com/,provider:p.WeboProvider},{name:"Twitter",test:/twitter\.com/,provider:h.TwitterProvider},{name:"搜狗搜索",test:/www\.sogou\.com/,provider:v.SoGouProvider},{name:"百度搜索",test:/www\.baidu\.com/,provider:d.BaiduProvider},{name:"百度视频",test:/v\.baidu\.com/,provider:y.BaiduVideoProvider},{name:"百度学术",test:/xueshu\.baidu\.com/,provider:_.BaiduXueshuProvider},{name:"百度贴吧",test:/tieba\.baidu\.com/,provider:c.TiebaProvider},{name:"掘金",test:/juejin\.im/,provider:b.JuejinProvider}]).bootstrap()},function(t,e,n){"use strict";t.exports=n(6).polyfill()},function(t,e,n){(function(e,r){/*!
 * @overview es6-promise - a tiny implementation of Promises/A+.
 * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)
 * @license   Licensed under MIT license
 *            See https://raw.githubusercontent.com/stefanpenner/es6-promise/master/LICENSE
 * @version   4.1.1
 */
!function(e,n){t.exports=n()}(0,function(){"use strict";function t(t){var e=typeof t;return null!==t&&("object"===e||"function"===e)}function o(t){return"function"==typeof t}function i(t){z=t}function u(t){$=t}function c(){return void 0!==W?function(){W(a)}:s()}function s(){var t=setTimeout;return function(){return t(a,1)}}function a(){for(var t=0;t<G;t+=2){(0,K[t])(K[t+1]),K[t]=void 0,K[t+1]=void 0}G=0}function f(t,e){var n=arguments,r=this,o=new this.constructor(p);void 0===o[tt]&&D(o);var i=r._state;return i?function(){var t=n[i-1];$(function(){return R(i,o,t,r._result)})}():P(r,o,t,e),o}function l(t){var e=this;if(t&&"object"==typeof t&&t.constructor===e)return t;var n=new e(p);return g(n,t),n}function p(){}function h(){return new TypeError("You cannot resolve a promise with itself")}function v(){return new TypeError("A promises callback cannot return that same promise.")}function d(t){try{return t.then}catch(t){return ot.error=t,ot}}function y(t,e,n,r){try{t.call(e,n,r)}catch(t){return t}}function _(t,e,n){$(function(t){var r=!1,o=y(n,e,function(n){r||(r=!0,e!==n?g(t,n):O(t,n))},function(e){r||(r=!0,E(t,e))},"Settle: "+(t._label||" unknown promise"));!r&&o&&(r=!0,E(t,o))},t)}function b(t,e){e._state===nt?O(t,e._result):e._state===rt?E(t,e._result):P(e,void 0,function(e){return g(t,e)},function(e){return E(t,e)})}function m(t,e,n){e.constructor===t.constructor&&n===f&&e.constructor.resolve===l?b(t,e):n===ot?(E(t,ot.error),ot.error=null):void 0===n?O(t,e):o(n)?_(t,e,n):O(t,e)}function g(e,n){e===n?E(e,h()):t(n)?m(e,n,d(n)):O(e,n)}function w(t){t._onerror&&t._onerror(t._result),j(t)}function O(t,e){t._state===et&&(t._result=e,t._state=nt,0!==t._subscribers.length&&$(j,t))}function E(t,e){t._state===et&&(t._state=rt,t._result=e,$(w,t))}function P(t,e,n,r){var o=t._subscribers,i=o.length;t._onerror=null,o[i]=e,o[i+nt]=n,o[i+rt]=r,0===i&&t._state&&$(j,t)}function j(t){var e=t._subscribers,n=t._state;if(0!==e.length){for(var r=void 0,o=void 0,i=t._result,u=0;u<e.length;u+=3)r=e[u],o=e[u+n],r?R(n,r,o,i):o(i);t._subscribers.length=0}}function T(){this.error=null}function x(t,e){try{return t(e)}catch(t){return it.error=t,it}}function R(t,e,n,r){var i=o(n),u=void 0,c=void 0,s=void 0,a=void 0;if(i){if(u=x(n,r),u===it?(a=!0,c=u.error,u.error=null):s=!0,e===u)return void E(e,v())}else u=r,s=!0;e._state!==et||(i&&s?g(e,u):a?E(e,c):t===nt?O(e,u):t===rt&&E(e,u))}function A(t,e){try{e(function(e){g(t,e)},function(e){E(t,e)})}catch(e){E(t,e)}}function N(){return ut++}function D(t){t[tt]=ut++,t._state=void 0,t._result=void 0,t._subscribers=[]}function I(t,e){this._instanceConstructor=t,this.promise=new t(p),this.promise[tt]||D(this.promise),F(e)?(this.length=e.length,this._remaining=e.length,this._result=new Array(this.length),0===this.length?O(this.promise,this._result):(this.length=this.length||0,this._enumerate(e),0===this._remaining&&O(this.promise,this._result))):E(this.promise,S())}function S(){return new Error("Array Methods must be provided an Array")}function C(t){return new I(this,t).promise}function M(t){var e=this;return new e(F(t)?function(n,r){for(var o=t.length,i=0;i<o;i++)e.resolve(t[i]).then(n,r)}:function(t,e){return e(new TypeError("You must pass an array to race."))})}function H(t){var e=this,n=new e(p);return E(n,t),n}function k(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function U(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}function L(t){this[tt]=N(),this._result=this._state=void 0,this._subscribers=[],p!==t&&("function"!=typeof t&&k(),this instanceof L?A(this,t):U())}function V(){var t=void 0;if(void 0!==r)t=r;else if("undefined"!=typeof self)t=self;else try{t=Function("return this")()}catch(t){throw new Error("polyfill failed because global object is unavailable in this environment")}var e=t.Promise;if(e){var n=null;try{n=Object.prototype.toString.call(e.resolve())}catch(t){}if("[object Promise]"===n&&!e.cast)return}t.Promise=L}var q=void 0;q=Array.isArray?Array.isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)};var F=q,G=0,W=void 0,z=void 0,$=function(t,e){K[G]=t,K[G+1]=e,2===(G+=2)&&(z?z(a):Q())},Z="undefined"!=typeof window?window:void 0,B=Z||{},Y=B.MutationObserver||B.WebKitMutationObserver,J="undefined"==typeof self&&void 0!==e&&"[object process]"==={}.toString.call(e),X="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel,K=new Array(1e3),Q=void 0;Q=J?function(){return function(){return e.nextTick(a)}}():Y?function(){var t=0,e=new Y(a),n=document.createTextNode("");return e.observe(n,{characterData:!0}),function(){n.data=t=++t%2}}():X?function(){var t=new MessageChannel;return t.port1.onmessage=a,function(){return t.port2.postMessage(0)}}():void 0===Z?function(){try{var t=n(8);return W=t.runOnLoop||t.runOnContext,c()}catch(t){return s()}}():s();var tt=Math.random().toString(36).substring(16),et=void 0,nt=1,rt=2,ot=new T,it=new T,ut=0;return I.prototype._enumerate=function(t){for(var e=0;this._state===et&&e<t.length;e++)this._eachEntry(t[e],e)},I.prototype._eachEntry=function(t,e){var n=this._instanceConstructor,r=n.resolve;if(r===l){var o=d(t);if(o===f&&t._state!==et)this._settledAt(t._state,e,t._result);else if("function"!=typeof o)this._remaining--,this._result[e]=t;else if(n===L){var i=new n(p);m(i,t,o),this._willSettleAt(i,e)}else this._willSettleAt(new n(function(e){return e(t)}),e)}else this._willSettleAt(r(t),e)},I.prototype._settledAt=function(t,e,n){var r=this.promise;r._state===et&&(this._remaining--,t===rt?E(r,n):this._result[e]=n),0===this._remaining&&O(r,this._result)},I.prototype._willSettleAt=function(t,e){var n=this;P(t,void 0,function(t){return n._settledAt(nt,e,t)},function(t){return n._settledAt(rt,e,t)})},L.all=C,L.race=M,L.resolve=l,L.reject=H,L._setScheduler=i,L._setAsap=u,L._asap=$,L.prototype={constructor:L,then:f,catch:function(t){return this.then(null,t)}},L.polyfill=V,L.Promise=L,L})}).call(e,n(7),n(3))},function(t,e){function n(){throw new Error("setTimeout has not been defined")}function r(){throw new Error("clearTimeout has not been defined")}function o(t){if(f===setTimeout)return setTimeout(t,0);if((f===n||!f)&&setTimeout)return f=setTimeout,setTimeout(t,0);try{return f(t,0)}catch(e){try{return f.call(null,t,0)}catch(e){return f.call(this,t,0)}}}function i(t){if(l===clearTimeout)return clearTimeout(t);if((l===r||!l)&&clearTimeout)return l=clearTimeout,clearTimeout(t);try{return l(t)}catch(e){try{return l.call(null,t)}catch(e){return l.call(this,t)}}}function u(){d&&h&&(d=!1,h.length?v=h.concat(v):y=-1,v.length&&c())}function c(){if(!d){var t=o(u);d=!0;for(var e=v.length;e;){for(h=v,v=[];++y<e;)h&&h[y].run();y=-1,e=v.length}h=null,d=!1,i(t)}}function s(t,e){this.fun=t,this.array=e}function a(){}var f,l,p=t.exports={};!function(){try{f="function"==typeof setTimeout?setTimeout:n}catch(t){f=n}try{l="function"==typeof clearTimeout?clearTimeout:r}catch(t){l=r}}();var h,v=[],d=!1,y=-1;p.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];v.push(new s(t,e)),1!==v.length||d||o(c)},s.prototype.run=function(){this.fun.apply(null,this.array)},p.title="browser",p.browser=!0,p.env={},p.argv=[],p.version="",p.versions={},p.on=a,p.addListener=a,p.once=a,p.off=a,p.removeListener=a,p.removeAllListeners=a,p.emit=a,p.binding=function(t){throw new Error("process.binding is not supported")},p.cwd=function(){return"/"},p.chdir=function(t){throw new Error("process.chdir is not supported")},p.umask=function(){return 0}},function(t,e){},function(t,e,n){"use strict";var r=this&&this.__decorate||function(t,e,n,r){var o,i=arguments.length,u=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(t,e,n,r);else for(var c=t.length-1;c>=0;c--)(o=t[c])&&(u=(i<3?o(u):i>3?o(e,n,u):o(e,n))||u);return i>3&&u&&Object.defineProperty(e,n,u),u};Object.defineProperty(e,"__esModule",{value:!0});var o=n(1),i=function(){function t(){this.provides=[],this.onScrollHandler=[],this.onHoverHandler=[]}return t.prototype.setConfig=function(t){return this.config=t,this},t.prototype.provide=function(t){return this.provides=t,this},t.prototype.getProvider=function(){for(var t=[],e=this.provides.slice();e.length;){var n=e.shift();n.test.test(document.domain)&&t.push(n)}return t},t.prototype.onHover=function(t){var e=t.target;"A"===e.tagName&&this.onHoverHandler.forEach(function(t){t(e)})},t.prototype.onScroll=function(){var t=[].slice.call(document.querySelectorAll('a[href^="http"]')).filter(function(t){return o.isInView(t)&&o.getRedirect(t)<=2});this.onScrollHandler.forEach(function(e){e(t)})},t.prototype.bootstrap=function(){var t=this;addEventListener("DOMContentLoaded",function(){for(var e=t.getProvider();e.length;){var n=e.shift();console.info("[Anti-redirect]: Load "+n.name);var r=n.provider,o=(new r).setConfig(t.config).onInit();t.onScrollHandler.push(o.onScroll.bind(o)),t.onHoverHandler.push(o.onHover.bind(o)),window.scrollY<=0&&t.onScroll()}}),addEventListener("scroll",this.onScroll.bind(this)),addEventListener("mousemove",this.onHover.bind(this)),console.log("%c Anti-Redirect %c Copyright © 2015-%s %s",'font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;font-size:64px;color:#00bbee;-webkit-text-fill-color:#00bbee;-webkit-text-stroke: 1px #00bbee;',"font-size:12px;color:#999999;",(new Date).getFullYear(),"\nAuthor @Axetroy")},r([o.debounceDecorator(300)],t.prototype,"onScroll",null),t}();e.App=i},function(t,e,n){(function(e){function n(t,e,n){function r(e){var n=d,r=y;return d=y=void 0,P=e,b=t.apply(r,n)}function i(t){return P=t,m=setTimeout(f,e),j?r(t):b}function u(t){var n=t-g,r=t-P,o=e-n;return T?O(o,_-r):o}function a(t){var n=t-g,r=t-P;return void 0===g||n>=e||n<0||T&&r>=_}function f(){var t=E();if(a(t))return l(t);m=setTimeout(f,u(t))}function l(t){return m=void 0,x&&d?r(t):(d=y=void 0,b)}function p(){void 0!==m&&clearTimeout(m),P=0,d=g=y=m=void 0}function h(){return void 0===m?b:l(E())}function v(){var t=E(),n=a(t);if(d=arguments,y=this,g=t,n){if(void 0===m)return i(g);if(T)return m=setTimeout(f,e),r(g)}return void 0===m&&(m=setTimeout(f,e)),b}var d,y,_,b,m,g,P=0,j=!1,T=!1,x=!0;if("function"!=typeof t)throw new TypeError(s);return e=c(e)||0,o(n)&&(j=!!n.leading,T="maxWait"in n,_=T?w(c(n.maxWait)||0,e):_,x="trailing"in n?!!n.trailing:x),v.cancel=p,v.flush=h,v}function r(t,e,r){var i=!0,u=!0;if("function"!=typeof t)throw new TypeError(s);return o(r)&&(i="leading"in r?!!r.leading:i,u="trailing"in r?!!r.trailing:u),n(t,e,{leading:i,maxWait:e,trailing:u})}function o(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}function i(t){return!!t&&"object"==typeof t}function u(t){return"symbol"==typeof t||i(t)&&g.call(t)==f}function c(t){if("number"==typeof t)return t;if(u(t))return a;if(o(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=o(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=t.replace(l,"");var n=h.test(t);return n||v.test(t)?d(t.slice(2),n?2:8):p.test(t)?a:+t}var s="Expected a function",a=NaN,f="[object Symbol]",l=/^\s+|\s+$/g,p=/^[-+]0x[0-9a-f]+$/i,h=/^0b[01]+$/i,v=/^0o[0-7]+$/i,d=parseInt,y="object"==typeof e&&e&&e.Object===Object&&e,_="object"==typeof self&&self&&self.Object===Object&&self,b=y||_||Function("return this")(),m=Object.prototype,g=m.toString,w=Math.max,O=Math.min,E=function(){return b.Date.now()};t.exports=r}).call(e,n(3))},function(t,e,n){(function(e){function n(t,e,n){function o(e){var n=d,r=y;return d=y=void 0,P=e,b=t.apply(r,n)}function i(t){return P=t,m=setTimeout(f,e),j?o(t):b}function s(t){var n=t-E,r=t-P,o=e-n;return T?w(o,_-r):o}function a(t){var n=t-E,r=t-P;return void 0===E||n>=e||n<0||T&&r>=_}function f(){var t=O();if(a(t))return l(t);m=setTimeout(f,s(t))}function l(t){return m=void 0,x&&d?o(t):(d=y=void 0,b)}function p(){void 0!==m&&clearTimeout(m),P=0,d=E=y=m=void 0}function h(){return void 0===m?b:l(O())}function v(){var t=O(),n=a(t);if(d=arguments,y=this,E=t,n){if(void 0===m)return i(E);if(T)return m=setTimeout(f,e),o(E)}return void 0===m&&(m=setTimeout(f,e)),b}var d,y,_,b,m,E,P=0,j=!1,T=!1,x=!0;if("function"!=typeof t)throw new TypeError(c);return e=u(e)||0,r(n)&&(j=!!n.leading,T="maxWait"in n,_=T?g(u(n.maxWait)||0,e):_,x="trailing"in n?!!n.trailing:x),v.cancel=p,v.flush=h,v}function r(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}function o(t){return!!t&&"object"==typeof t}function i(t){return"symbol"==typeof t||o(t)&&m.call(t)==a}function u(t){if("number"==typeof t)return t;if(i(t))return s;if(r(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=r(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=t.replace(f,"");var n=p.test(t);return n||h.test(t)?v(t.slice(2),n?2:8):l.test(t)?s:+t}var c="Expected a function",s=NaN,a="[object Symbol]",f=/^\s+|\s+$/g,l=/^[-+]0x[0-9a-f]+$/i,p=/^0b[01]+$/i,h=/^0o[0-7]+$/i,v=parseInt,d="object"==typeof e&&e&&e.Object===Object&&e,y="object"==typeof self&&self&&self.Object===Object&&self,_=d||y||Function("return this")(),b=Object.prototype,m=b.toString,g=Math.max,w=Math.min,O=function(){return _.Date.now()};t.exports=n}).call(e,n(3))},function(t,e,n){/*!
 * in-view 0.6.1 - Get notified when a DOM element enters or exits the viewport.
 * Copyright (c) 2016 Cam Wiegert <cam@camwiegert.com> - https://camwiegert.github.io/in-view
 * License: MIT
 */
!function(e,n){t.exports=n()}(0,function(){return function(t){function e(r){if(n[r])return n[r].exports;var o=n[r]={exports:{},id:r,loaded:!1};return t[r].call(o.exports,o,o.exports,e),o.loaded=!0,o.exports}var n={};return e.m=t,e.c=n,e.p="",e(0)}([function(t,e,n){"use strict";var r=n(2),o=function(t){return t&&t.__esModule?t:{default:t}}(r);t.exports=o.default},function(t,e){function n(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}t.exports=n},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var o=n(9),i=r(o),u=n(3),c=r(u),s=n(4);e.default=function(){if("undefined"!=typeof window){var t=["scroll","resize","load"],e={history:[]},n={offset:{},threshold:0,test:s.inViewport},r=(0,i.default)(function(){e.history.forEach(function(t){e[t].check()})},100);t.forEach(function(t){return addEventListener(t,r)}),window.MutationObserver&&addEventListener("DOMContentLoaded",function(){new MutationObserver(r).observe(document.body,{attributes:!0,childList:!0,subtree:!0})});var o=function(t){if("string"==typeof t){var r=[].slice.call(document.querySelectorAll(t));return e.history.indexOf(t)>-1?e[t].elements=r:(e[t]=(0,c.default)(r,n),e.history.push(t)),e[t]}};return o.offset=function(t){if(void 0===t)return n.offset;var e=function(t){return"number"==typeof t};return["top","right","bottom","left"].forEach(e(t)?function(e){return n.offset[e]=t}:function(r){return e(t[r])?n.offset[r]=t[r]:null}),n.offset},o.threshold=function(t){return"number"==typeof t&&t>=0&&t<=1?n.threshold=t:n.threshold},o.test=function(t){return"function"==typeof t?n.test=t:n.test},o.is=function(t){return n.test(t,n)},o.offset(0),o}}()},function(t,e){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=function(){function t(e,r){n(this,t),this.options=r,this.elements=e,this.current=[],this.handlers={enter:[],exit:[]},this.singles={enter:[],exit:[]}}return r(t,[{key:"check",value:function(){var t=this;return this.elements.forEach(function(e){var n=t.options.test(e,t.options),r=t.current.indexOf(e),o=r>-1,i=n&&!o,u=!n&&o;i&&(t.current.push(e),t.emit("enter",e)),u&&(t.current.splice(r,1),t.emit("exit",e))}),this}},{key:"on",value:function(t,e){return this.handlers[t].push(e),this}},{key:"once",value:function(t,e){return this.singles[t].unshift(e),this}},{key:"emit",value:function(t,e){for(;this.singles[t].length;)this.singles[t].pop()(e);for(var n=this.handlers[t].length;--n>-1;)this.handlers[t][n](e);return this}}]),t}();e.default=function(t,e){return new o(t,e)}},function(t,e){"use strict";function n(t,e){var n=t.getBoundingClientRect(),r=n.top,o=n.right,i=n.bottom,u=n.left,c=n.width,s=n.height,a={t:i,r:window.innerWidth-u,b:window.innerHeight-r,l:o},f={x:e.threshold*c,y:e.threshold*s};return a.t>e.offset.top+f.y&&a.r>e.offset.right+f.x&&a.b>e.offset.bottom+f.y&&a.l>e.offset.left+f.x}Object.defineProperty(e,"__esModule",{value:!0}),e.inViewport=n},function(t,e){(function(e){var n="object"==typeof e&&e&&e.Object===Object&&e;t.exports=n}).call(e,function(){return this}())},function(t,e,n){var r=n(5),o="object"==typeof self&&self&&self.Object===Object&&self,i=r||o||Function("return this")();t.exports=i},function(t,e,n){function r(t,e,n){function r(e){var n=b,r=m;return b=m=void 0,P=e,w=t.apply(r,n)}function f(t){return P=t,O=setTimeout(h,e),j?r(t):w}function l(t){var n=t-E,r=t-P,o=e-n;return T?a(o,g-r):o}function p(t){var n=t-E,r=t-P;return void 0===E||n>=e||n<0||T&&r>=g}function h(){var t=i();return p(t)?v(t):void(O=setTimeout(h,l(t)))}function v(t){return O=void 0,x&&b?r(t):(b=m=void 0,w)}function d(){void 0!==O&&clearTimeout(O),P=0,b=E=m=O=void 0}function y(){return void 0===O?w:v(i())}function _(){var t=i(),n=p(t);if(b=arguments,m=this,E=t,n){if(void 0===O)return f(E);if(T)return O=setTimeout(h,e),r(E)}return void 0===O&&(O=setTimeout(h,e)),w}var b,m,g,w,O,E,P=0,j=!1,T=!1,x=!0;if("function"!=typeof t)throw new TypeError(c);return e=u(e)||0,o(n)&&(j=!!n.leading,T="maxWait"in n,g=T?s(u(n.maxWait)||0,e):g,x="trailing"in n?!!n.trailing:x),_.cancel=d,_.flush=y,_}var o=n(1),i=n(8),u=n(10),c="Expected a function",s=Math.max,a=Math.min;t.exports=r},function(t,e,n){var r=n(6),o=function(){return r.Date.now()};t.exports=o},function(t,e,n){function r(t,e,n){var r=!0,c=!0;if("function"!=typeof t)throw new TypeError(u);return i(n)&&(r="leading"in n?!!n.leading:r,c="trailing"in n?!!n.trailing:c),o(t,e,{leading:r,maxWait:e,trailing:c})}var o=n(7),i=n(1),u="Expected a function";t.exports=r},function(t,e){function n(t){return t}t.exports=n}])})},function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(e,"__esModule",{value:!0});var o=n(0),i=n(1),u=function(t){function e(){var e=t.call(this)||this;return e.test=/link\.zhihu\.com\/\?target=(.*)/,e}return r(e,t),e.prototype.onScroll=function(t){var e=this;t.forEach(function(t){e.onHover(t)})},e.prototype.onHover=function(t){this.emit(this.ANTI_REDIRECT_DONE_EVENT,t,i.matchLinkFromUrl(t,this.test))},e}(o.Provider);e.ZhihuZhuanlanProvider=u},function(t,e,n){!function(e,n){t.exports=n()}(0,function(){return function(t){function e(r){if(n[r])return n[r].exports;var o=n[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,e),o.l=!0,o.exports}var n={};return e.m=t,e.c=n,e.i=function(t){return t},e.d=function(t,n,r){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:r})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=0)}([function(t,e,n){"use strict";function r(){return Math.random().toString(36).substr(2,16)}function o(t){return this.findIndex(function(e){return e[c]===t})}function i(){this[u]={},s&&s(this,u,{enumerable:!1,configurable:!1})}Object.defineProperty(e,"__esModule",{value:!0});var u="@axetroy/event-emitter.js",c="__id__",s=Object.defineProperty,a=i.prototype;a.constructor=i,a.on=function(t,e){var n=this[u],i=n[t]=n[t]||[],s=r(),a=void 0;return e[c]=s,i.push(e),function(){(a=o.call(i,s))>=0&&i.splice(a,1)}},a.off=function(t){this[u][t]=[]},a.clear=function(){this[u]={}},a.once=function(t,e){var n=this,i=n[u],s=i[t]=i[t]||[],a=r(),f=void 0,l=function(){f=o.call(s,a),f>=0&&s.splice(f,1),e.apply(n,arguments)};l[c]=a,s.push(l)},a.emit=function(){var t=this,e=[].slice.call(arguments),n=e.shift(),r=t[u];(r["*"]||[]).concat(r[n]||[]).map(function(r){return t.emitting(n,e,r)})},a.emitting=function(t,e,n){n.apply(this,e)},e.default=i}])})},function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(e,"__esModule",{value:!0});var o=n(0),i=n(1),u=function(t){function e(){var e=t.call(this)||this;return e.test=/zhihu\.com\/\?target=(.*)/,e}return r(e,t),e.prototype.onScroll=function(t){var e=this;t.forEach(function(t){e.onHover(t)})},e.prototype.onHover=function(t){this.emit(this.ANTI_REDIRECT_DONE_EVENT,t,i.matchLinkFromUrl(t,this.test))},e}(o.Provider);e.ZhihuDailyProvider=u},function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(e,"__esModule",{value:!0});var o=n(0),i=function(t){function e(){var e=t.call(this)||this;return e.test=/jump\d*\.bdimg\.com/,e}return r(e,t),e.prototype.onScroll=function(t){var e=this;t.forEach(function(t){e.onHover(t)})},e.prototype.onHover=function(t){if(this.test.test(t.href)){var e="",n=t.innerText||t.textContent||"";try{e=decodeURIComponent(n)}catch(t){e=/https?:\/\//.test(n)?n:""}e&&this.emit(this.ANTI_REDIRECT_DONE_EVENT,t,e)}},e}(o.Provider);e.TiebaProvider=i},function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(e,"__esModule",{value:!0});var o=n(0),i=function(t){function e(){var e=t.call(this)||this;return e.test=/nothing/,e}return r(e,t),e.prototype.onScroll=function(t){var e=this;t.forEach(function(t){e.onHover(t)})},e.prototype.onHover=function(t){if(t.getAttribute("onmousedown")&&t.removeAttribute("onmousedown"),t.getAttribute("data-href")){var e=t.getAttribute("data-href");this.emit(this.ANTI_REDIRECT_DONE_EVENT,t,e)}},e}(o.Provider);e.GoogleProvider=i},function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(e,"__esModule",{value:!0});var o=n(0),i=n(1),u=function(t){function e(){var e=t.call(this)||this;return e.test=/www\.google\.com\/url\?q=(.*)/,e}return r(e,t),e.prototype.onScroll=function(t){var e=this;t.forEach(function(t){e.onHover(t)})},e.prototype.onHover=function(t){this.emit(this.ANTI_REDIRECT_DONE_EVENT,t,i.matchLinkFromUrl(t,this.test))},e}(o.Provider);e.GoogleDocsProvider=u},function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(e,"__esModule",{value:!0});var o=n(0),i=n(1),u=function(t){function e(){var e=t.call(this)||this;return e.test=/zhihu\.com\/\?target=(.*)/,e}return r(e,t),e.prototype.onScroll=function(t){var e=this;t.forEach(function(t){e.onHover(t)})},e.prototype.onHover=function(t){this.emit(this.ANTI_REDIRECT_DONE_EVENT,t,i.matchLinkFromUrl(t,this.test))},e}(o.Provider);e.ZhihuProvider=u},function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(e,"__esModule",{value:!0});var o=n(0),i=n(1),u=function(t){function e(){var e=t.call(this)||this;return e.test=/so\.com\/link\?url=(.*)/,e}return r(e,t),e.prototype.onScroll=function(t){},e.prototype.onHover=function(t){this.emit(this.ANTI_REDIRECT_DONE_EVENT,t,i.matchLinkFromUrl(t,this.test)),t.removeAttribute("data-res"),t.href=t.href.replace(/\&(q|t|ts|src)=[^\&]*/g,"");var e=t.getAttribute("data-url");e&&(t.href=e)},e}(o.Provider);e.SoProvider=u},function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(e,"__esModule",{value:!0});var o=n(0),i=function(t){function e(){var e=t.call(this)||this;return e.test=/t\.cn\/\w+/,e}return r(e,t),e.prototype.onScroll=function(t){var e=this;t.forEach(function(t){e.onHover(t)})},e.prototype.onHover=function(t){if(this.test.test(t.href)&&/^https?:\/\//.test(t.title)){var e=decodeURIComponent(t.title);e&&(t.href=e,this.emit(this.ANTI_REDIRECT_DONE_EVENT,t,e))}},e}(o.Provider);e.WeboProvider=i},function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(e,"__esModule",{value:!0});var o=n(0),i=function(t){function e(){var e=t.call(this)||this;return e.test=/t\.co\/\w+/,e}return r(e,t),e.prototype.onScroll=function(t){var e=this;t.forEach(function(t){e.onHover(t)})},e.prototype.onHover=function(t){if(this.test.test(t.href)&&/^https?:\/\//.test(t.title)){var e=decodeURIComponent(t.title);e&&this.emit(this.ANTI_REDIRECT_DONE_EVENT,t,e)}},e}(o.Provider);e.TwitterProvider=i},function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),o=this&&this.__decorate||function(t,e,n,r){var o,i=arguments.length,u=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(t,e,n,r);else for(var c=t.length-1;c>=0;c--)(o=t[c])&&(u=(i<3?o(u):i>3?o(e,n,u):o(e,n))||u);return i>3&&u&&Object.defineProperty(e,n,u),u},i=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))(function(o,i){function u(t){try{s(r.next(t))}catch(t){i(t)}}function c(t){try{s(r.throw(t))}catch(t){i(t)}}function s(t){t.done?o(t.value):new n(function(e){e(t.value)}).then(u,c)}s((r=r.apply(t,e||[])).next())})},u=this&&this.__generator||function(t,e){function n(t){return function(e){return r([t,e])}}function r(n){if(o)throw new TypeError("Generator is already executing.");for(;s;)try{if(o=1,i&&(u=i[2&n[0]?"return":n[0]?"throw":"next"])&&!(u=u.call(i,n[1])).done)return u;switch(i=0,u&&(n=[0,u.value]),n[0]){case 0:case 1:u=n;break;case 4:return s.label++,{value:n[1],done:!1};case 5:s.label++,i=n[1],n=[0];continue;case 7:n=s.ops.pop(),s.trys.pop();continue;default:if(u=s.trys,!(u=u.length>0&&u[u.length-1])&&(6===n[0]||2===n[0])){s=0;continue}if(3===n[0]&&(!u||n[1]>u[0]&&n[1]<u[3])){s.label=n[1];break}if(6===n[0]&&s.label<u[1]){s.label=u[1],u=n;break}if(u&&s.label<u[2]){s.label=u[2],s.ops.push(n);break}u[2]&&s.ops.pop(),s.trys.pop();continue}n=e.call(t,s)}catch(t){n=[6,t],i=0}finally{o=u=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var o,i,u,c,s={label:0,sent:function(){if(1&u[0])throw u[1];return u[1]},trys:[],ops:[]};return c={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(c[Symbol.iterator]=function(){return this}),c};Object.defineProperty(e,"__esModule",{value:!0});var c=n(2),s=n(0),a=n(1),f=function(t){function e(){var e=t.call(this)||this;return e.test=/www\.sogou\.com\/link\?url=/,e}return r(e,t),e.prototype.handlerOneElement=function(t){return i(this,void 0,void 0,function(){var e,n,r,o;return u(this,function(i){switch(i.label){case 0:if(!this.test.test(t.href))return[2];i.label=1;case 1:return i.trys.push([1,4,,5]),a.getRedirect(t)<=2&&this.test.test(t.href)?(a.increaseRedirect(t),[4,c.default.get(t.href)]):[3,3];case 2:e=i.sent(),a.decreaseRedirect(t),n=e.finalUrl,n&&!this.test.test(n)?this.emit(this.ANTI_REDIRECT_DONE_EVENT,t,e.finalUrl):(r=e.responseText.match(/URL=['"]([^'"]+)['"]/))&&r[1]&&this.emit(this.ANTI_REDIRECT_DONE_EVENT,t,r[1]),i.label=3;case 3:return[3,5];case 4:return o=i.sent(),a.decreaseRedirect(t),console.error(o),[3,5];case 5:return[2]}})})},e.prototype.onScroll=function(t){var e=this;t.forEach(function(t){e.handlerOneElement(t)})},e.prototype.onHover=function(t){this.handlerOneElement(t)},e.prototype.parsePage=function(t){var e=this,n=t.responseText.replace(/(src=[^>]*|link=[^>])/g,""),r=document.createElement("html");r.innerHTML=n;var o=[].slice.call(r.querySelectorAll("#main .results a[href]"));[].slice.call(document.querySelectorAll('#main .results a[href*="www.sogou.com/link?url="]')).forEach(function(t){o.forEach(function(n){var r=a.getText(t),o=a.getText(n);t.classList.contains("str-public-btn")?(r=a.getText(t.parentNode),o=a.getText(n.parentNode)):t.classList.contains("str_img")&&(r=a.getText(t.parentNode.parentNode),o=a.getText(n.parentNode.parentNode)),r&&r===o&&e.emit(e.ANTI_REDIRECT_DONE_EVENT,t,n.href)})})},e.prototype.onInit=function(){var t=this;if(/www\.sogou\.com\/web/.test(window.top.location.href)){var e=a.queryParser(window.top.location.search),n=location.protocol.replace(/:$/,"").replace("s","")+"://"+(location.host+location.pathname+e);return c.default.get(n).then(function(e){t.parsePage(e)}).catch(function(t){console.error(t)}),this}},o([a.throttleDecorator(500)],e.prototype,"onHover",null),e}(s.Provider);e.SoGouProvider=f},function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),o=this&&this.__decorate||function(t,e,n,r){var o,i=arguments.length,u=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(t,e,n,r);else for(var c=t.length-1;c>=0;c--)(o=t[c])&&(u=(i<3?o(u):i>3?o(e,n,u):o(e,n))||u);return i>3&&u&&Object.defineProperty(e,n,u),u},i=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))(function(o,i){function u(t){try{s(r.next(t))}catch(t){i(t)}}function c(t){try{s(r.throw(t))}catch(t){i(t)}}function s(t){t.done?o(t.value):new n(function(e){e(t.value)}).then(u,c)}s((r=r.apply(t,e||[])).next())})},u=this&&this.__generator||function(t,e){function n(t){return function(e){return r([t,e])}}function r(n){if(o)throw new TypeError("Generator is already executing.");for(;s;)try{if(o=1,i&&(u=i[2&n[0]?"return":n[0]?"throw":"next"])&&!(u=u.call(i,n[1])).done)return u;switch(i=0,u&&(n=[0,u.value]),n[0]){case 0:case 1:u=n;break;case 4:return s.label++,{value:n[1],done:!1};case 5:s.label++,i=n[1],n=[0];continue;case 7:n=s.ops.pop(),s.trys.pop();continue;default:if(u=s.trys,!(u=u.length>0&&u[u.length-1])&&(6===n[0]||2===n[0])){s=0;continue}if(3===n[0]&&(!u||n[1]>u[0]&&n[1]<u[3])){s.label=n[1];break}if(6===n[0]&&s.label<u[1]){s.label=u[1],u=n;break}if(u&&s.label<u[2]){s.label=u[2],s.ops.push(n);break}u[2]&&s.ops.pop(),s.trys.pop();continue}n=e.call(t,s)}catch(t){n=[6,t],i=0}finally{o=u=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var o,i,u,c,s={label:0,sent:function(){if(1&u[0])throw u[1];return u[1]},trys:[],ops:[]};return c={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(c[Symbol.iterator]=function(){return this}),c};Object.defineProperty(e,"__esModule",{value:!0});var c=n(2),s=n(0),a=n(1),f=function(t){function e(){var e=t.call(this)||this;return e.test=/www\.baidu\.com\/link\?url=/,e}return r(e,t),e.prototype.onScroll=function(t){var e=this;t.forEach(function(t){a.getRedirect(t)<=2&&e.test.test(t.href)&&(a.increaseRedirect(t),e.handlerOneElement(t).then(function(e){a.decreaseRedirect(t)}).catch(function(e){a.decreaseRedirect(t)}))})},e.prototype.handlerOneElement=function(t){return i(this,void 0,void 0,function(){var e,n;return u(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,c.default.get(t.href)];case 1:return e=r.sent(),e.finalUrl&&this.emit(this.ANTI_REDIRECT_DONE_EVENT,t,e.finalUrl),[2,e];case 2:return n=r.sent(),console.error(n),[3,3];case 3:return[2]}})})},e.prototype.onHover=function(t,e){this.test.test(t.href)&&this.handlerOneElement(t)},e.prototype.onInit=function(){return this},o([a.throttleDecorator(500)],e.prototype,"onHover",null),e}(s.Provider);e.BaiduProvider=f},function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),o=this&&this.__decorate||function(t,e,n,r){var o,i=arguments.length,u=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(t,e,n,r);else for(var c=t.length-1;c>=0;c--)(o=t[c])&&(u=(i<3?o(u):i>3?o(e,n,u):o(e,n))||u);return i>3&&u&&Object.defineProperty(e,n,u),u};Object.defineProperty(e,"__esModule",{value:!0});var i=n(2),u=n(0),c=n(1),s=function(t){function e(){var e=t.call(this)||this;return e.test=/v\.baidu\.com\/link\?url=/,e}return r(e,t),e.prototype.onScroll=function(t){},e.prototype.onHover=function(t){var e=this;this.test.test(t.href)&&i.default.get(t.href).then(function(n){n.finalUrl&&e.emit(e.ANTI_REDIRECT_DONE_EVENT,t,n.finalUrl)}).catch(function(t){console.error(t)})},o([c.throttleDecorator(500)],e.prototype,"onHover",null),e}(u.Provider);e.BaiduVideoProvider=s},function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(e,"__esModule",{value:!0});var o=n(0),i=function(t){function e(){var e=t.call(this)||this;return e.test=/xueshu\.baidu\.com\/\?(.*)/,e}return r(e,t),e.prototype.onScroll=function(t){var e=this;t.forEach(function(t){e.onHover(t)})},e.prototype.onHover=function(t){var e=t.getAttribute("data-link");e&&this.emit(this.ANTI_REDIRECT_DONE_EVENT,t,decodeURIComponent(e))},e}(o.Provider);e.BaiduXueshuProvider=i},function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(e,"__esModule",{value:!0});var o=n(0),i=n(1),u=function(t){function e(){var e=t.call(this)||this;return e.test=/link\.juejin\.im\/\?target=(.*)/,e}return r(e,t),e.prototype.onScroll=function(t){var e=this;t.forEach(function(t){e.onHover(t)})},e.prototype.onHover=function(t){this.emit(this.ANTI_REDIRECT_DONE_EVENT,t,i.matchLinkFromUrl(t,this.test))},e}(o.Provider);e.JuejinProvider=u}]);